<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Automating Peak Identification using R | Cherin-Juliette | Portfolio</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Automating Peak Identification using R | Cherin-Juliette | Portfolio" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="cherjuliette/dsfb2_bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Automating Peak Identification using R | Cherin-Juliette | Portfolio" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  



<meta name="date" content="2022-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-file-management-using-the-guerilla-method.html"/>
<link rel="next" href="evaluating-the-global-dengue-fever-and-flu-cases-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cherin-Juliette | Portfolio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hi there!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i><b>1.1</b> About Me</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#future-ambitions"><i class="fa fa-check"></i><b>1.2</b> Future Ambitions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#months-goals"><i class="fa fa-check"></i><b>1.2.1</b> <strong>3 Months Goals</strong></a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#year-goals"><i class="fa fa-check"></i><b>1.2.2</b> <strong>1 Year Goals</strong></a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#years-goals"><i class="fa fa-check"></i><b>1.2.3</b> <strong>5 Years Goals</strong></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#my-resume"><i class="fa fa-check"></i><b>1.3</b> My Resume</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#education"><i class="fa fa-check"></i><b>1.3.1</b> Education</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#research-experience"><i class="fa fa-check"></i><b>1.3.2</b> Research Experience</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#work-experience"><i class="fa fa-check"></i><b>1.3.3</b> Work Experience</a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#honors-courses"><i class="fa fa-check"></i><b>1.3.4</b> Honors Courses</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#expanding-my-skill-set"><i class="fa fa-check"></i><b>1.4</b> Expanding My Skill Set</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reproducibility-in-data-science.html"><a href="reproducibility-in-data-science.html"><i class="fa fa-check"></i><b>2</b> Reproducibility in Data Science</a></li>
<li class="chapter" data-level="3" data-path="dose-response-analysis-of-c.-elegans.html"><a href="dose-response-analysis-of-c.-elegans.html"><i class="fa fa-check"></i><b>3</b> Dose Response Analysis of C. elegans</a></li>
<li class="chapter" data-level="4" data-path="data-file-management-using-the-guerilla-method.html"><a href="data-file-management-using-the-guerilla-method.html"><i class="fa fa-check"></i><b>4</b> Data &amp; File Management using the Guerilla Method</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-file-management-using-the-guerilla-method.html"><a href="data-file-management-using-the-guerilla-method.html#example"><i class="fa fa-check"></i><b>4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="automating-peak-identification-using-r.html"><a href="automating-peak-identification-using-r.html"><i class="fa fa-check"></i><b>5</b> Automating Peak Identification using R</a></li>
<li class="chapter" data-level="6" data-path="evaluating-the-global-dengue-fever-and-flu-cases-in-r.html"><a href="evaluating-the-global-dengue-fever-and-flu-cases-in-r.html"><i class="fa fa-check"></i><b>6</b> Evaluating the global Dengue Fever and Flu cases in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="evaluating-the-global-dengue-fever-and-flu-cases-in-r.html"><a href="evaluating-the-global-dengue-fever-and-flu-cases-in-r.html#conclusions-on-the-dengue-dataset"><i class="fa fa-check"></i><b>6.1</b> Conclusions on the dengue dataset</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="making-r-package-rcolorutrecht.html"><a href="making-r-package-rcolorutrecht.html"><i class="fa fa-check"></i><b>7</b> Making R package rcolorUtrecht</a></li>
<li class="chapter" data-level="8" data-path="evaluating-covid-19-cases-and-deaths.html"><a href="evaluating-covid-19-cases-and-deaths.html"><i class="fa fa-check"></i><b>8</b> Evaluating COVID-19 cases and deaths</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cherin-Juliette | Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="automating-peak-identification-using-r" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Automating Peak Identification using R<a href="automating-peak-identification-using-r.html#automating-peak-identification-using-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Naja Pallida snake is a native of Western Africa. When threatened, it shoots venom into the eyes of its adversary, briefly blinding them and giving them time to flee. This impact is explored in zoological laboratories. When a snake bites a human, little cloats form {<span class="citation">Bittenbinder et al. (<a href="#ref-Bittenbinder2018" role="doc-biblioref">2018</a>)</span>}, which might cause the individual to die (ABC Science).</p>
<p>The Institute for Life Sciences is well-known for its participation in snake venom research. This is because a previous pupil, Jory van Thiel, has been infatuated with snakes since he was a child. He once came to see us at college and told us about his fascination with snakes, how he acted in self-defense rather than malice, and how he even had his own pet snake. During his travels to Asia a snake spat venom in his eyes which blinded him temporarily and made him understand the defence mechanism of the Naja Pallida {<span class="citation"><span>“Leidse Biologiestudenten in Diverse Media over Spugende Cobra’s”</span> (<a href="#ref-universiteitleiden" role="doc-biblioref">n.d.</a>)</span>}. A study which got him published in Science!</p>
<p>Snakes, as Jory once noted, are normally fairly sweet, but that doesn’t mean their means of self-defense isn’t harmful, if not lethal. In the laboratory, researchers are attempting to establish what makes the venom so lethal, as well as whether there are any benefits to the venom that could be used in the development of an anti-venom or the therapy of certain heart diseases {<span class="citation">Kazandjian et al. (<a href="#ref-Kazandjian2021" role="doc-biblioref">2021</a>)</span>}.
Rat hearts were exposed to venom ex vivo in order to uncover a possible cure for excessive blood loss, specific cardiac diseases, and to find an anti-venom. This is accomplished using a Langendorff setup that includes a heart attached to the Langendorff and venom administered through a tube.</p>
<p>This setup is done at the Institute of Life Sciences with venom from the Naja Pallida and the Crotalus atrox {<span class="citation">McKeller and Pérez (<a href="#ref-McKeller2002" role="doc-biblioref">n.d.</a>)</span>}. These venoms were tested on rat hearts ex vivo and human neuroblastoma cells (SKNAS) in vitro. When we look at the results in vitro, we can observe that cells deteriorate quickly. This effect is reduced when the inhibitor Varespladib is added {<span class="citation">Lewin et al. (<a href="#ref-Lewin2016" role="doc-biblioref">2016</a>)</span>}. For this reason the compound Varespladib is researched as a possible anti-dote {<span class="citation">Zinenko, Tovstukha, and Korniyenko (<a href="#ref-Zinenko2020" role="doc-biblioref">2020</a>)</span>}.</p>
<p>When considering the effect seen ex vivo, which means the venom is administered via the Langendorff setup, we can see the venom’s effect on the heart, but we can also see the peak pattern that is formed. The reason for this is that when the rat’s heart is removed, Ringer buffer is provided, causing the heart to beat somewhat longer than usual when taken from the body. When the venom is delivered, we can detect a peak pattern that indicates cardiac contractions. The researchers on the lab manually calculated data from the experiment, such as the number of peaks, maximal contraction force (the peak height), and beats per minute. The disadvantage is that the technique is extremely error-prone, and bias can readily creep in. This method is automated to avoid avoidable errors and save time for the researchers.</p>
<p>I participated in this project with two other students, which was commissioned by the Institute of Life Sciences’ Zoology department and was carried out under the supervision of Dr. Micheal Liem.</p>
<p>In R, a for loop was used to automate the peak identification process. We created a for-loop that examines the data file and determines if a peak is a peak by determining whether it has crossed a “hill.” When you first enter the dataset, it will rise upwards with a peak before descending again. Every time the loop runs, it checks this procedure and records the number of peaks in a new file. In addition, another loop was created that calculates the beats per minute (bpm) during a 5-second period. This appears to be a very short time, but keep in mind that an experiment like this one typically lasts 30 to 45 minutes and that physiological consequences like cell degregation and blood clot development occur extremely quickly when exposed to snake venom.</p>
<p>As with any experiment that produces peaks, we must also consider that some noise will be introduced. Noise is defined as peaks that appear on the graph but were not caused by the experiment. They were most likely caused by an analist accidentally bumping against the table, improper Langendorff setups, or any number of minor factors. To reduce the noise from the graph, we used a technique known as thresholding. This means that we examine a graph and determine how high the peaks are on average. This is the contraction force or strength. Peaks that are significantly smaller than the general peaks will not pass the threshold and will be filtered out.
Sounds simple enough, doesn’t it? Well, we discovered that the more experiments performed, the more different the peak graph may appear. Meaning, if an analist is jittery after his seventh cup of coffee and is having a clumsy day, significantly more noise will be noticed on the graph, and they may not all be the same height. Another explanation could be that a different setup was employed, or that the venom was used at a different concentration.
To provide the commissioning party with the most accurate information, we have chosen to let the analist chose the threshold for themself. This is done by writing a function in the loop which doesn’t establish a fixed value as a threshold but rather lets the user choose it.</p>
<p>Even while sometimes we forget the rest of the Institute for Life Sciences doesn’t love the language R as much as we do, it did dawn on us that we couldn’t simply hand in an R script and call it a day. For this reason we made a R Shiny app, which is an UI written purely with R and a little HTML and CSS for the look. In this app, the user will be presented with a README, and a page where they may upload the data file. The graphs will then be generated for them and they can afterwards choose a threshold.</p>
<p>This is an ungoing project. Want to keep track? <a href="https://github.com/ProjecticumDataScience/dsfb2_project_regenworm">Check out the project repo on GitHub</a>!</p>
<p>Also check out my repository for the minor course I followed to see how I use bookdown to combine all my separate projects.</p>

</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bittenbinder2018" class="csl-entry">
Bittenbinder, Mátyás A., Christina N. Zdenek, Bianca op den Brouw, Nicholas J. Youngman, James S. Dobson, Arno Naude, Freek J. Vonk, and Bryan G. Fry. 2018. <span>“Coagulotoxic Cobras: Clinical Implications of Strong Anticoagulant Actions of African Spitting Naja Venoms That Are Not Neutralised by Antivenom but Are by <span>LY</span>315920 (Varespladib).”</span> <em>Toxins</em> 10 (12): 516. <a href="https://doi.org/10.3390/toxins10120516">https://doi.org/10.3390/toxins10120516</a>.
</div>
<div id="ref-Kazandjian2021" class="csl-entry">
Kazandjian, T. D., D. Petras, S. D. Robinson, J. van Thiel, H. W. Greene, K. Arbuckle, A. Barlow, et al. 2021. <span>“Convergent Evolution of Pain-Inducing Defensive Venom Components in Spitting Cobras.”</span> <em>Science</em> 371 (6527): 386–90. <a href="https://doi.org/10.1126/science.abb9303">https://doi.org/10.1126/science.abb9303</a>.
</div>
<div id="ref-universiteitleiden" class="csl-entry">
<span>“Leidse Biologiestudenten in Diverse Media over Spugende Cobra’s.”</span> n.d. <em>Universiteit Leiden</em>. <a href="https://www.universiteitleiden.nl/nieuws/2021/02/leidse-biologiestudenten-in-kijk-over-spugende-cobras">https://www.universiteitleiden.nl/nieuws/2021/02/leidse-biologiestudenten-in-kijk-over-spugende-cobras</a>.
</div>
<div id="ref-Lewin2016" class="csl-entry">
Lewin, Matthew, Stephen Samuel, Janie Merkel, and Philip Bickler. 2016. <span>“Varespladib (<span>LY</span>315920) Appears to Be a Potent, Broad-Spectrum, Inhibitor of Snake Venom Phospholipase A2 and a Possible Pre-Referral Treatment for Envenomation.”</span> <em>Toxins</em> 8 (9): 248. <a href="https://doi.org/10.3390/toxins8090248">https://doi.org/10.3390/toxins8090248</a>.
</div>
<div id="ref-McKeller2002" class="csl-entry">
McKeller, Morgan R, and John C Pérez. n.d. <span>“The Effects of Western Diamondback Rattlesnake (Crotalus Atrox) Venom on the Production of Antihemorrhagins and/or Antibodies in the Virginia Opossum (Didelphis Virginiana).”</span> <em>Toxicon</em> 40 (4): 427–39. <a href="https://doi.org/10.1016/s0041-0101(01)00220-3">https://doi.org/10.1016/s0041-0101(01)00220-3</a>.
</div>
<div id="ref-Zinenko2020" class="csl-entry">
Zinenko, Oleksandr, Igor Tovstukha, and Yevgen Korniyenko. 2020. <span>“<span>PLA</span>2 Inhibitor Varespladib as an Alternative to the Antivenom Treatment for Bites from Nikolsky’s Viper Vipera Berus Nikolskii.”</span> <em>Toxins</em> 12 (6): 356. <a href="https://doi.org/10.3390/toxins12060356">https://doi.org/10.3390/toxins12060356</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-file-management-using-the-guerilla-method.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluating-the-global-dengue-fever-and-flu-cases-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/005_dsfb2_projectintro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
